<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:pcmds="clr-namespace:Playnite.Commands;assembly=Playnite"
                    xmlns:pbeh="clr-namespace:Playnite.Behaviors;assembly=Playnite"
                    xmlns:pctrlsShared="clr-namespace:Playnite.Controls;assembly=Playnite"
                    xmlns:views="clr-namespace:Playnite.DesktopApp.Controls.Views;assembly=Playnite.DesktopApp"
                    xmlns:pctrls="clr-namespace:Playnite.DesktopApp.Controls;assembly=Playnite.DesktopApp"
                    xmlns:pmrk="clr-namespace:Playnite.DesktopApp.Markup;assembly=Playnite.DesktopApp"
                    xmlns:playnite="clr-namespace:Playnite;assembly=Playnite"
                    xmlns:sys="clr-namespace:System;assembly=mscorlib">

    <Style x:Key="MainListItemStyle" TargetType="{x:Type ListBoxItem}">
        <Setter Property="Foreground" Value="{DynamicResource TextBrushDarker}" />
        <Setter Property="OverridesDefaultStyle" Value="True" />
        <Setter Property="FontSize" Value="15" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ListBoxItem}">
                    <Grid>
                        <Border x:Name="SelectedRectangle" IsHitTestVisible="False" Visibility="Collapsed"
                                                        BorderThickness="5,0,0,0" BorderBrush="{DynamicResource GlyphBrush}"/>
                        <Border x:Name="HoverRectangle" IsHitTestVisible="False" Visibility="Collapsed"
                                                        BorderThickness="5,0,0,0" BorderBrush="{DynamicResource GlyphBrush}"/>
                        <Border Padding="{TemplateBinding Padding}" Background="Transparent">
                            <ContentPresenter Margin="10,3,0,3"/>
                        </Border>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <DataTrigger Binding="{Binding IsInstalled}" Value="True">
                            <Setter Property="Foreground" Value="{StaticResource TextBrush}" />
                        </DataTrigger>
                        <DataTrigger Binding="{Binding IsInstalled}" Value="False">
                            <Setter Property="Foreground" Value="{StaticResource TextBrushDarker}" />
                        </DataTrigger>
                        <Trigger Property="IsFocused" Value="True">
                            <Setter Property="Visibility" Value="Visible" TargetName="SelectedRectangle" />
                        </Trigger>
                        <Trigger Property="IsSelected" Value="true">
                            <Setter Property="Visibility" Value="Visible" TargetName="SelectedRectangle" />
                            <Setter Property="Foreground" Value="{DynamicResource GlyphBrush}" />
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="True" />
                                <Condition Property="IsSelected" Value="False" />
                            </MultiTrigger.Conditions>
                            <Setter Property="Visibility" Value="Visible" TargetName="HoverRectangle" />
                            <Setter Property="Foreground" Value="{DynamicResource TextBrush}" />
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="True" />
                                <Condition Property="IsSelected" Value="True" />
                            </MultiTrigger.Conditions>
                            <Setter Property="Visibility" Value="Visible" TargetName="HoverRectangle" />
                            <Setter Property="Foreground" Value="{DynamicResource TextBrush}" />
                        </MultiTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>    

    <Style TargetType="{x:Type views:LibraryDetailsView}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type views:LibraryDetailsView}">
                    <DockPanel>
                        <pctrlsShared:ExtendedListBox SelectionMode="Extended"
                            Width="350" DockPanel.Dock="Left"
                            BorderThickness="0"                                                      
                            SelectedItem="{Binding SelectedGame, Mode=TwoWay}"
                            SelectedItemsList="{Binding SelectedGamesBinder, Mode=TwoWay}"
                            ItemContainerStyle="{DynamicResource MainListItemStyle}"
                            ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                            ScrollViewer.PanningMode="VerticalOnly"
                            pbeh:ScrollToSelectedBehavior.Enabled="True"
                            VirtualizingPanel.CacheLengthUnit="Item"
                            VirtualizingPanel.CacheLength="5"
                            VirtualizingPanel.IsVirtualizingWhenGrouping="True"
                            VirtualizingPanel.VirtualizationMode="Recycling"
                            Background="{DynamicResource GamesListPanelBrush}">
                            <pctrlsShared:ExtendedListBox.Style>
                                <!--Improves performances by not populating list when other views are used-->
                                <Style TargetType="pctrlsShared:ExtendedListBox" BasedOn="{StaticResource {x:Type pctrlsShared:ExtendedListBox}}">
                                    <Setter Property="ItemsSource" Value="{x:Null}" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{pmrk:Settings ViewSettings.GamesViewType}" Value="{x:Static playnite:ViewType.Details}">
                                            <Setter Property="ItemsSource" Value="{Binding GamesView.CollectionView}" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </pctrlsShared:ExtendedListBox.Style>
                            <pctrlsShared:ExtendedListBox.ContextMenu>
                                <pctrls:GameMenu DataContext="{pmrk:MainViewModel SelectedGames}" />
                            </pctrlsShared:ExtendedListBox.ContextMenu>
                            <ListBox.InputBindings>
                                <KeyBinding Command="{Binding EditSelectedGamesCommand}"
                                Key ="{Binding EditSelectedGamesCommand.Gesture.Key}"
                                Modifiers="{Binding EditSelectedGamesCommand.Gesture.Modifiers}" />
                                <KeyBinding Command="{Binding RemoveSelectedGamesCommand}"
                                Key ="{Binding RemoveSelectedGamesCommand.Gesture.Key}"
                                Modifiers="{Binding RemoveSelectedGamesCommand.Gesture.Modifiers}" />
                                <KeyBinding Command="{Binding StartSelectedGameCommand}"
                                Key ="{Binding StartSelectedGameCommand.Gesture.Key}"
                                Modifiers="{Binding StartSelectedGameCommand.Gesture.Modifiers}" />
                            </ListBox.InputBindings>
                            <pctrlsShared:ExtendedListBox.GroupStyle>
                                <GroupStyle>
                                    <GroupStyle.ContainerStyle>
                                        <Style TargetType="{x:Type GroupItem}">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate>
                                                        <Expander BorderThickness="0" IsExpanded="True"
                                                                  pbeh:ExpanderBehaviors.SaveState="True"
                                                                  pbeh:ExpanderBehaviors.SaveStateId="{Binding Name, Mode=OneWay}">
                                                            <Expander.Header>
                                                                <DockPanel Background="Transparent">
                                                                    <TextBlock DockPanel.Dock="Left"
                                                                               VerticalAlignment="Center" HorizontalAlignment="Left"
                                                                               TextAlignment="Center" Margin="0,0,5,0">
                                                                        <TextBlock.Style>                                                                            
                                                                            <Style TargetType="TextBlock" BasedOn="{StaticResource BaseTextBlockStyle}">
                                                                                <Setter Property="Text" Value="{Binding Name, Converter={StaticResource ObjectToStringConverter}}" />
                                                                                <Style.Triggers>
                                                                                    <DataTrigger Binding="{Binding Name, Converter={StaticResource ObjectToStringConverter}}" Value="{x:Null}">
                                                                                        <Setter Property="Text" Value="{DynamicResource LOCNone}" />
                                                                                    </DataTrigger>
                                                                                    <DataTrigger Binding="{Binding Name, Converter={StaticResource ObjectToStringConverter}}" Value="">
                                                                                        <Setter Property="Text" Value="{DynamicResource LOCNone}" />
                                                                                    </DataTrigger>
                                                                                </Style.Triggers> 
                                                                            </Style>
                                                                        </TextBlock.Style>
                                                                    </TextBlock>
                                                                    <TextBlock Text="{Binding Items.Count, Mode=OneWay, StringFormat=({0})}"
                                                                               VerticalAlignment="Center" HorizontalAlignment="Left"
                                                                               Style="{DynamicResource BaseTextBlockStyle}"
                                                                               DockPanel.Dock="Left" TextAlignment="Center"
                                                                               Visibility="{pmrk:Settings ShowIconsOnList}"/>
                                                                </DockPanel>
                                                            </Expander.Header>
                                                            <ItemsPresenter />
                                                        </Expander>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                    </GroupStyle.ContainerStyle>
                                </GroupStyle>
                            </pctrlsShared:ExtendedListBox.GroupStyle>
                            <pctrlsShared:ExtendedListBox.ItemTemplate>
                                <DataTemplate>
                                    <DockPanel Background="Transparent">
                                        <DockPanel.InputBindings>
                                            <MouseBinding MouseAction="LeftDoubleClick"
                                    Command="{pmrk:MainViewModel StartGameCommand, DirectValue=True}"
                                    CommandParameter="{Binding Game}"/>
                                        </DockPanel.InputBindings>
                                        <Image Height="26" RenderOptions.BitmapScalingMode="Fant"
                            DockPanel.Dock="Left" Margin="0,0,8,0"
                            Visibility="{pmrk:Settings ShowIconsOnList}">
                                            <Image.Source>
                                                <PriorityBinding>
                                                    <Binding Path="IconObject" IsAsync="{pmrk:Settings AsyncImageLoading, DirectValue=True}"
                                            Mode="OneWay" Converter="{StaticResource NullToDependencyPropertyUnsetConverter}" />
                                                    <Binding Path="DefaultIconObject" Mode="OneWay"/>
                                                </PriorityBinding>
                                            </Image.Source>
                                        </Image>
                                        <TextBlock Text="{Binding DisplayName}" TextTrimming="CharacterEllipsis"
                                VerticalAlignment="Center" DockPanel.Dock="Left">
                                        </TextBlock>
                                    </DockPanel>
                                </DataTemplate>
                            </pctrlsShared:ExtendedListBox.ItemTemplate>
                        </pctrlsShared:ExtendedListBox>
                        <views:DetailsGameOverview DockPanel.Dock="Left"
                        DataContext="{Binding SelectedGameDetails}" />
                    </DockPanel>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</ResourceDictionary>